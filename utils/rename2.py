uuid_paper_name_mapping_dict = {('gpt4.1', 'fb916818-0506-4be2-aa85-547119dbb8e3-1318ae506c2d98f1'): '2-HITs',
('gpt4.1',
  '36ea3cb5-93c8-4d6e-9af8-2d3e3391f0c2-82e1c9afd52a3392'): '19-Native-Sparse-Attention',
('gpt4.1', '8abe2fdc-fd76-40f2-a5a3-019981153c10-df9baae98fc28c17'): '3-DoLa',
('gpt4.1',
  'a176307c-eb5a-44ad-bd5c-0442f7395b6e-43d26e2430610e23'): '9-GDPZero',
('gpt4.1', '749b4dc3-78af-4bc8-a46b-096bc23e9eef-2fb61d2ad2da4dcb'): '4-CD',
('gpt4.1',
  'd302cc09-ac54-41d8-88ea-13c45214efca-f2cc2a3e8e3dd5dd'): '14-EmojiCrypt',
('gpt4.1',
  '725c52da-9449-4ae2-addc-a99a53c8f359-cc6d8217daf6ee76'): '30-ERGO',
('gpt4.1',
  '0b91e7cf-1e6d-4b37-a94e-319eaa744ff0-59ed100d88ab20ae'): '15-EmpathyBias',
('gpt4.1',
  '192a8c20-00e1-4353-8606-274a69b31853-886d1a5dd67e7735'): '5-SimPO',
('gpt4.1',
  '771c2c9b-1b9d-4235-afb6-090a36bf6a4d-093506abb0c34f06'): '13-DecBound',
('gpt4.1',
  '5efb4ff0-c882-42cd-9ff1-82b5861a175b-15f0f4536d45bef3'): '22-TokenDPO',
('gpt4.1',
  '4f2e2bc7-a225-4e55-8264-03eb5df50aaf-038dd42379203008'): '16-KnowProb',
('gpt4.1', '8e7df488-9878-40d0-9044-f11f31267c17-991e2c444a5277c5'): '6-RepE',
('gpt4.1',
  '88b3e3e1-6e63-4441-94e8-85e67cc684bb-ead27bbe59b59d29'): '23-SimCLR',
('gpt4.1',
  '5c5c8573-15e5-4023-94a4-08f141ea287c-a336f1aa27cb241d'): '18-MassActiv',
('gpt4.1', '7dbd2aaf-537b-4685-b956-0b5d29345f14-3d6e9ab0ac49370c'): '1-DPO',
('gpt4.1',
  'de57ecce-6401-4f93-b082-51331267ceed-6f3d810909db409f'): '7-bertscore',
('gpt4.1', 'a8378650-d6bf-4b4c-a0af-5669baed764f-416e7f0629355dda'): '20-CAD',
('gpt4.1',
  '9cdf2c83-a5d7-4cfb-904b-f4a5466c0071-3dd0f851bb178636'): '28-SPIN',
('gpt4.1',
  'b8054577-8343-4e10-b566-0fd1a69411f4-3f7dd3b062e3a991'): '19-Native-Sparse-Attention',
('o4mini', '4cd1e995-6b7a-47db-98aa-91cc3cd81c20-c1341530fb5a1303'): '4-CD',
('o4mini',
  '5751863e-ee06-4290-a3bd-e926c7f21338-89cd2bf1a9abcb7d'): '14-EmojiCrypt',
('o4mini',
  'd2312fc4-3ef8-4dec-90dd-b83812a17831-8967fa690abeab5f'): '30-ERGO',
('o4mini',
  '575d4622-3b8b-4145-b519-7c7640af4173-d3b46ce4c42e04c3'): '15-EmpathyBias',
('o4mini',
  '87fa395f-44ef-431e-8eb1-156a1932294b-a48f2fac46e887c6'): '5-SimPO',
('o4mini',
  'c0d14345-1d2f-4b5c-94d4-4e7cf0c2c222-d0b16dd0fd52cddc'): '11-moverscore',
('o4mini',
  'f0cc567d-d31f-4f32-afa0-8ebab2ebdbea-e4d50e90c0a86f40'): '13-DecBound',
('o4mini',
  'c80e88c1-6f11-451a-b9f1-aa39dca9e559-cbb6c3720eac4f33'): '22-TokenDPO',
('o4mini',
  'fe824010-7a51-4f8d-8dca-435472e0159a-692dfbb5063538e0'): '16-KnowProb',
('o4mini',
  '317603e9-9c44-431b-be28-52221be62f35-aee53636ae12627e'): '16-KnowProb',
('o4mini', '4933b8ea-291b-4246-9a7f-3939dab3f6d1-bff43091dd9f2b1d'): '6-RepE',
('o4mini',
  'c1c81520-6d13-4a15-be21-66a95f5cb3b8-df80278d38a26a11'): '8-StepLength',
('o4mini',
  '84dc6d33-27ba-4dc5-8463-d1509a2cf0db-8185ba1ba251aac7'): '18-MassActiv',
('o4mini',
  '50f00aab-33b9-4250-af00-eda7c158c003-54edf74847a67ca0'): '7-bertscore',
('o4mini', '1717e71f-9245-48ab-9a37-15573e4444f4-a8901768071f1079'): '20-CAD',
('o4mini',
  '2405adce-0d05-4a3e-a55e-7b1fb3eb185e-96564bd339cfb2f4'): '28-SPIN',
('o4mini',
  '7bef7fa7-ef36-444a-9c7f-4592119253a1-d0098c9315aa2328'): '31-Syn-Chain',
('o4mini',
  'abc14f7b-cd08-4853-9de4-71768e9a9dfd-9c9209a520daf698'): '25-AdaLora',
('o4mini',
  '26b34cd8-7945-415b-bc01-8db00e3a8f4d-bfd3c007d18d58ce'): '19-Native-Sparse-Attention',
('o4mini', 'cc5ee62a-fe7f-435c-b490-9339212c2547-45e866ab741f0fc9'): '1-DPO',
('o4mini',
  '25caa896-1e95-468c-abf5-a11debda06d6-937e9c3e2a0a463b'): '19-Native-Sparse-Attention',
('o4mini', '34f1300b-4b28-40e2-9543-f99270230954-cacc1b7c5228d937'): '1-DPO',
('o4mini',
  '39e0ac75-4248-47d8-993d-314031fc27c4-10af4e1ec1cdd54e'): '19-Native-Sparse-Attention',
('o4mini', 'a4472584-be56-4b47-9fc3-6decf711d764-cab633daaa3ecdcb'): '1-DPO',
('gpt4o', '4c5ffca9-a6dd-4e65-a11c-8b9112e07889-aa6f62d04345b913'): '2-HITs',
('gpt4o',
  'cf47b86d-eedb-4f79-b51b-78f978e4964e-d945a9395e83b4db'): '19-Native-Sparse-Attention',
('gpt4o',
  '054d985e-c72d-4c5b-a489-40727d8866b1-5ec3a2bfa30a280b'): '9-GDPZero',
('gpt4o', '3936cd57-d5b6-44e0-8c1d-3042fd5673a2-305093f55dc2cec6'): '4-CD',
('gpt4o',
  '7668ce25-ee98-4eff-9b3c-f56a192a9518-e11e8ad3f041186f'): '14-EmojiCrypt',
('gpt4o', '5816aa7d-0806-4d22-9b36-76b1eee70363-12788c6570b7e6ca'): '30-ERGO',
('gpt4o',
  '1fe2f699-b466-49d4-8c4c-dbd2968a439a-6202a93d1c8b8f87'): '15-EmpathyBias',
('gpt4o',
  'ff8e7038-569a-4460-ba2a-f5dc692d6e61-6781fa1505a4e087'): '11-moverscore',
('gpt4o',
  '1abdb307-c77f-4936-9dcb-57cc3824721c-a4724e567734880b'): '13-DecBound',
('gpt4o',
  '49617be8-0134-4d7f-8a09-f9d9f3e74ec0-10884f5dc91ea6dc'): '22-TokenDPO',
('gpt4o',
  'ff4e0065-4de5-4fcd-8b64-e0d52e5603a9-f7f55ca93973c7f7'): '16-KnowProb',
('gpt4o', '1cc01299-5eda-4ad1-9a02-df0a43f8af6f-5975993ca8272d06'): '6-RepE',
('gpt4o',
  '65ab3840-a8e1-4d7a-bd8d-99c567afdc2c-fb1914c1065bb44f'): '8-StepLength',
('gpt4o',
  'bb29f8f0-c53e-4759-bb01-0860bcb675b5-b58d51b3c30cf501'): '23-SimCLR',
('gpt4o', '7e392b15-3d5e-45f3-8af9-a5a454ebb708-f5d908880f01b962'): '20-CAD',
('gpt4o', '00054327-0106-4a3a-863e-d37a2032a091-fb3c373651968507'): '28-SPIN',
('gpt4o',
  'af869d9f-6e55-4af6-bf2b-089c0a68113e-8cb50ac0da33b307'): '25-AdaLora',
('gpt4o',
  '6d109397-97f6-4902-bf86-9f6025cab06a-5ca21e590e321634'): '19-Native-Sparse-Attention',
('gpt4o', 'd4e33cac-2dfb-48c4-8d1b-7dbab4fd8dcf-095c4a4ab26c7dea'): '1-DPO'}
import json
import os 
import sys
new_mapping_dict = {}
model_names = ['gpt4.1', 'o4mini', 'gpt4o']
for model_name in model_names:
    cur_root_path = f'/home/sxy240002/research_agent/NLPAgentBench/OpenHands_logs/{model_name}/file_store/sessions'
    for paper_uuid in os.listdir(cur_root_path):
        if len(paper_uuid) > 1:
            event_names = os.listdir(os.path.join(cur_root_path, paper_uuid,'events'))
            for event_name in event_names:
                event_path = os.path.join(cur_root_path, paper_uuid,'events', event_name)
                with open(event_path, 'r') as f:
                    cur_event = json.load(f)
                if 'action' in cur_event.keys():
                    if cur_event['action'] == 'read':
                        path_list = cur_event['args']['path'].split('/')
                        if len(path_list) > 4:
                            if path_list[3] == 'datasets':
                                paper_name = path_list[4]
                                if (model_name, paper_uuid) not in new_mapping_dict and (model_name, paper_uuid) not in uuid_paper_name_mapping_dict:
                                    new_mapping_dict.update({(model_name, paper_uuid):paper_name})
                                continue
 
root_path = '/home/sxy240002/research_agent/NLPAgentBench/OpenHands_logs'
 
for model_name in model_names:
    sessions_dir = os.path.join(root_path, model_name, 'file_store', 'sessions')
    if not os.path.isdir(sessions_dir):
        print(f"跳过：未找到目录 {sessions_dir}", file=sys.stderr)
        continue
 
    for old_uuid in os.listdir(sessions_dir):
        old_path = os.path.join(sessions_dir, old_uuid)
 
        # 只处理目录，跳过文件
        if not os.path.isdir(old_path):
            continue
 
        # 从映射表中获取新的文件夹名
        key = (model_name, old_uuid)
        if key not in new_mapping_dict:
            print(f"警告：映射中找不到 {key}", file=sys.stderr)
            continue
 
        new_name = new_mapping_dict[key]
        new_path = os.path.join(sessions_dir, new_name)
 
        # 避免覆盖已存在的目录
        if os.path.exists(new_path):
            print(f"目标已存在，跳过重命名：{new_path}", file=sys.stderr)
            continue
 
        # 执行重命名
        try:
            os.rename(old_path, new_path)
            print(f"重命名成功：{old_path} → {new_path}")
        except Exception as e:
            print(f"重命名失败：{old_path} → {new_path}，错误：{e}", file=sys.stderr)