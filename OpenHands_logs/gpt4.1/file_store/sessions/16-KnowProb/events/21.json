{"id": 21, "timestamp": "2025-05-16T17:12:30.478906", "source": "agent", "message": "Code executed in IPython cell.", "cause": 20, "observation": "run_ipython", "tool_call_metadata": {"function_name": "execute_ipython_cell", "tool_call_id": "call_9BK8EFothFYWf0954bAvQPFc", "model_response": {"id": "chatcmpl-BXxa0wPTlgIFhVCuPzYrntbmKCXbP", "created": 1747433548, "model": "gpt-4.1-2025-04-14", "object": "chat.completion", "system_fingerprint": "fp_b38e740b47", "choices": [{"finish_reason": "tool_calls", "index": 0, "message": {"content": null, "role": "assistant", "tool_calls": [{"function": {"arguments": "{\"code\":\"import PyPDF2\\npdf_path = '/workspace/benchmark/datasets/16-KnowProb/KnowProb-main/paper.pdf'\\nwith open(pdf_path, 'rb') as f:\\n    reader = PyPDF2.PdfReader(f)\\n    num_pages = len(reader.pages)\\n    first_page = reader.pages[0].extract_text()\\n    last_page = reader.pages[-1].extract_text()\\n    sample_pages = [reader.pages[i].extract_text() for i in range(min(5, num_pages))]\\nnum_pages, first_page[:500], last_page[:500], sample_pages\"}", "name": "execute_ipython_cell"}, "id": "call_9BK8EFothFYWf0954bAvQPFc", "type": "function"}], "function_call": null, "annotations": []}}], "usage": {"completion_tokens": 142, "prompt_tokens": 5482, "total_tokens": 5624, "completion_tokens_details": {"accepted_prediction_tokens": 0, "audio_tokens": 0, "reasoning_tokens": 0, "rejected_prediction_tokens": 0}, "prompt_tokens_details": {"audio_tokens": 0, "cached_tokens": 5248}}, "service_tier": "default"}, "total_calls_in_response": 1}, "content": "(11,\n 'Proceedings of the 7th BlackboxNLP Workshop: Analyzing and Interpreting Neural Networks for NLP , pages 604\u2013614\\nNovember 15, 2024 \u00a92024 Association for Computational Linguistics\\nProbing Language Models on Their Knowledge Source\\nZineddine Tighidet1, 2, Andrea Mogini1, Jiali Mei1, Benjamin Piwowarski2,\\nPatrick Gallinari2, 3\\n1BNP Paribas, Paris, France\\n2Sorbonne Universit\u00e9, CNRS, ISIR, F-75005 Paris, France\\n3Criteo AI Lab, Paris, France\\nfirstname.lastname@ {isir.upmc.fr, bnpparibas.com }\\nAbstract\\nL',\n '0 500 1000 1500 2000 2500 3000 3500\\nCountmother-tonguethe-official-languagepart-of-continentofficial-religionbelong-to-continentcapital-ofis-headquartercommunicatecapital-city-ofis-citizen-ofnativehave-citizenship-ofproduct-manufacture-byair-on-originallyshare-borderplay-in-positionwork-in-fieldis-subclassproduct-develope-byheadquarters-inproduct-release-byowned-bydevelop-bydebut-onpremiere-onborder-withhold-citizenship-oflocateheadquarterthat-originate-inborn-inlegal-termcitizen-oflocated-into-',\n ['Proceedings of the 7th BlackboxNLP Workshop: Analyzing and Interpreting Neural Networks for NLP , pages 604\u2013614\\nNovember 15, 2024 \u00a92024 Association for Computational Linguistics\\nProbing Language Models on Their Knowledge Source\\nZineddine Tighidet1, 2, Andrea Mogini1, Jiali Mei1, Benjamin Piwowarski2,\\nPatrick Gallinari2, 3\\n1BNP Paribas, Paris, France\\n2Sorbonne Universit\u00e9, CNRS, ISIR, F-75005 Paris, France\\n3Criteo AI Lab, Paris, France\\nfirstname.lastname@ {isir.upmc.fr, bnpparibas.com }\\nAbstract\\nLarge Language Models (LLMs) often en-\\ncounter conflicts between their learned, in-\\nternal (parametric knowledge, PK) and exter-\\nnal knowledge provided during inference (con-\\ntextual knowledge, CK). Understanding how\\nLLMs models prioritize one knowledge source\\nover the other remains a challenge. In this pa-\\nper, we propose a novel probing framework\\nto explore the mechanisms governing the se-\\nlection between PK and CK in LLMs. Us-\\ning controlled prompts designed to contradict\\nthe model\u2019s PK, we demonstrate that specific\\nmodel activations are indicative of the knowl-\\nedge source employed. We evaluate this frame-\\nwork on various LLMs of different sizes and\\ndemonstrate that mid-layer activations, particu-\\nlarly those related to relations in the input, are\\ncrucial in predicting knowledge source selec-\\ntion, paving the way for more reliable models\\ncapable of handling knowledge conflicts effec-\\ntively.\\n1 Introduction\\nLarge Language Models (LLMs) have demon-\\nstrated remarkable proficiency in memorizing and\\nretrieving massive amounts of information. De-\\nspite these strengths, LLMs often struggle when\\nexposed to novel information not seen during train-\\ning (Ovadia et al., 2019) or when there is a conflict\\nbetween their parametric knowledge (PK) and\\nthecontext knowledge (CK) provided at infer-\\nence (Xie et al., 2024). Such discrepancies can\\nlead to erroneous outputs, a phenomenon that re-\\nmains a significant challenge in LLMs applications\\n(Ji et al., 2023). While several approaches, such\\nas reinforcement learning and retrieval-augmented\\ngeneration, have been proposed to mitigate these\\nissues (Ziegler et al., 2020; Lewis et al., 2021), the\\nmechanisms by which LLMs select and prioritize\\nknowledge sources are not well understood, sug-\\ngesting a gap in current research methodologies.\\nSouth\\nAmerica\\nEurope\\nactivations\\nParametric\\nKnowledge (PK)\\nExternal Context\\nKnowledge (CK)\\nPredictive ModelCKPK\\nBrazil is located in Europe.\\nBrazil is located in _\\nKnowledge SourceFigure 1: Illustration of our method for probing knowl-\\nedge sources in LLMs. We present the model with\\na prompt containing contradictory information to its\\nlearned knowledge to test whether it uses parametric\\nknowledge (PK) or contextual knowledge (CK). The\\nresulting activations are used to train a classifier to dis-\\ntinguish between PK and CK.\\nThis paper explores the internal dynamics of\\nLLMs, and more precisely decoder-only layers, fo-\\ncusing on their decision-making processes regard-\\ning the use of CK versus PK. By prompting the\\nLLM in a way that contradicts its PK, we probe the\\nmodel\u2019s knowledge-sourcing behaviors. By train-\\ning a linear classifier on model activations, our ex-\\nperiments reveal that certain activations correlate\\nwith determining whether context or parametric\\nknowledge predominates in the generated outputs.\\nIn this paper, we make the following key find-\\nings and contributions:\\n\u2022We define a framework that characterizes the\\nsource of knowledge used by the model to\\ngenerate its outputs \u2013 Sections 3 and 4. To\\nfacilitate further research and validation of\\nour findings, we make our framework publicly604',\n  'available on GitHub1.\\n\u2022Specific activations are indicative of the\\nknowledge source: by applying our frame-\\nwork to LLMs of different sizes, we estab-\\nlish that specific activations correlate with\\nthe model\u2019s use of contextual or parametric\\nknowledge.\\n2 Related Work\\nThe understanding of the mechanisms and knowl-\\nedge localization within transformers has pro-\\ngressed through various studies. On the one hand,\\nsome work investigated the PK-based outputs (fac-\\ntual setting) (Meng et al., 2023; Geva et al., 2021,\\n2023; AlKhamissi et al., 2022; Heinzerling and\\nInui, 2021). These works hypothesized that LLMs\\nstore parametric information in the Multi-Layer\\nPerceptron (MLP), which acts as a key-value mem-\\nory, subsequently accessed by the Multi-Head Self-\\nAttention (MHSA) mechanisms. On the other\\nhand, other studies focused on the CK-based out-\\nputs and concluded that processing CK, as opposed\\nto PK, is not specifically localized in the LLM\u2019s\\nparameters (Monea et al., 2024).\\nYu et al. (2023) employed an attribution method\\n(Wang et al., 2022; Belrose et al., 2023) to identify\\nthe most influential attention heads responsible for\\ngenerating PK and CK outputs, and subsequently\\nadjusted the weights of these heads to modify the\\nsource of knowledge. Their work however focuses\\nexclusively on knowledge specific to capital cities\\nand relies on causal tracing, which is costly to\\ncompute.\\nIn contrast, our work utilizes a probing approach\\nthat uses a classifier on the LLM activations to\\nidentify the source of knowledge, leveraging the\\ninsights from previous research on the respective\\nroles of MLPs and MHSAs in the inference process.\\nWe extend the scope of Yu et al. (2023) by incorpo-\\nrating a dataset with a broader range of knowledge\\ncategories ( ParaRel (Elazar et al., 2021)), moving\\nbeyond just capital cities.\\n3 Methodology\\nWe aim to show that specific activations correlate\\nwith the used knowledge source, parametric or con-\\ntext knowledge. In order to probe LLMs, we con-\\nstruct prompts that are composed of inputs rep-\\n1Link to the code and dataset: https://github.com/\\nZineddine-Tighidet/knowledge-probing-frameworkresenting information about a subject sthat con-\\ntradicts what the model learned during training,\\nfollowed by a query about the same subject (see\\nFigure 1). If the model answers according to the\\nprompt, then it uses context knowledge. On the\\nother hand, if the model answers according to what\\nit learned, then it is using its parametric knowledge.\\nIn the following two sections, we define more for-\\nmally PK and CK.\\n3.1 Parametric Knowledge (PK)\\nWe consider the parametric knowledge (PK) to be\\nthe information that the model learned during train-\\ning. More specifically, we restrict this PK by using\\na knowledge base KB={(s, r, o )}, i.e. a set of\\n(subject, relation, object) triplets from the ParaRel\\ndataset (Elazar et al., 2021). We then define PK to\\nbe the set of objects that are generated by a LLM:\\nPK={(s, r, o\u2032)| \u2203os.t.(s, r, o )\u2208KB\\n\u2227o\u2032=G\u03b8(q(s, r))}(1)\\nwhere G\u03b8is an LLM; q(s, r)is a prompt in natural\\nlanguage corresponding to a subject-relation pair\\n(s, r);o\u2032is the output of G\u03b8given the query prompt\\n(e.g. \"Brazil is located in the continent of _\" ).\\nNote that we use this method to define PK be-\\ncause we do not have access to the training data\\nof LLMs in general, and, more importantly, we\\nare interested in what the LLM infers by itself. If\\no=G\u03b8(q(s, r)), that is, the object owas gener-\\nated by the model after providing an input query\\nq(s, r), we can conclude that the model learned to\\nassociate the object owith the subject swith the\\nrelation rduring training. Note also that, unlike\\nprevious work (Meng et al., 2023; Yu et al., 2023),\\neven when ois factually incorrect (e.g. \"Paris is the\\ncapital of Italy\" ), we still consider it in our study\\nas our only interest is the parametric knowledge\\nand not the external world factual truth2.\\n3.1.1 Knowledge Base (ParaRel)\\nWe extend the ParaRel dataset (Elazar et al., 2021)\\nfor constructing a parametric knowledge base.\\nParaRel dataset consists of triplets, each composed\\nof a subject, a relation, and an object. Table 1\\nillustrates a sample of the raw ParaRel dataset.\\nWhile the majority of the triplets adhere to\\nthe subject-relation-object structure, some deviate\\n2This behavior happens when the subjects are unpopular\\nand the LLM was not trained on enough examples. We discuss\\nthis further in Section 6.605',\n  'Complete the following statement directly and concisely with the\\nname of the place where the headquarters of Microsoft  are located .\\nDo not try to answer with a detailed explanation, just answer in a\\nfew words without being specific. Do not use an y specific formatting\\nand end the output with a point.\\nHere is an example: BNP P aribas is headquartered in P aris.\\nMicrosoft is headquartered in\\n Redmond.Figure 2: Example of the template used to generate the parametric knowledge dataset. The blue text is proper to the\\nrelation and the orange is specific to a subject-relation example in the ParaRel dataset (Elazar et al., 2021).\\nfrom this format. To ensure consistency, a pre-\\nprocessing step was applied on the raw ParaRel\\ndataset using Mistral-Large3. Specifically, the goal\\nwas to transform triplets where the subject precedes\\nthe relation (e.g., \"The official language of France\\nis French.\" ) into triplets where the subject is placed\\ndirectly before the relation (e.g., \"France\u2019s official\\nlanguage is French.\" ). We selected Mistral-Large\\nbecause it is open-weight, enabling reproducibil-\\nity, and its capabilities are very close to those of\\nGPT-4.\\n3.1.2 Parametric Knowledge Query Format\\nTo guide the studied LLMs towards generating\\nparametric knowledge objects that are coherent\\nwith the relation and to help specifying the type of\\nobject that is expected when there are multiple pos-\\nsible answers (for example in \"Napoleon passed\\naway in\" the LLM can generate the place of death\\n\"Longwood\" or the year of death \"1821\" ) we pro-\\npose to use a template prompt that is illustrated\\nin Figure 2. The prompt specifies the requested\\ntype of object with a brief description as well as\\nan example (one-shot learning) to help the LLM\\nunderstand the kind of object that is intended (il-\\nlustrated in blue in Figure 2). The description and\\nexample were manually created for each relation.\\nThe prompt also tries to guide the LLM towards\\ngenerating a concise output as these models tend\\nto give a long explanation that is irrelevant in our\\nstudy (e.g. Amazon is headquartered in the city of\\nSeattle where Starbucks is also headquartered... ).\\n3.1.3 Subject/Object Bias\\nThe subject can sometimes provide relevant infor-\\nmation about the object which can bias our def-\\ninition of parametric knowledge (e.g. Princeton\\n3https://mistral.ai/news/mistral-large/University Press is located in Princeton. orNiger\\nshares the border with Nigeria ). To avoid this, we\\nremoved examples where the subject is similar to\\nthe object, utilizing the Jaro-Winkler string dis-\\ntance (Jaro\u2013Winkler) with a threshold empirically\\nfixed at 0.8. This method is advantageous for our\\ndataset, as it assigns closer distances to subjects\\nwith the same prefix as the objects, which is com-\\nmon in cases like \"Croatia\u2019s official language is\\nCroatian\" where \"Croatia\" and\"Croatian\" have\\nthe same prefix.\\n3.2 Context Knowledge (CK)\\nIn our framework, we perturb the LLM by pro-\\nviding a CK that contradicts the PK, which we\\nname counter-PK and denote PK. It is challeng-\\ning to test what the model does not know (Yin\\net al., 2023). One way to build these inputs is to\\ncontradict what the model learned during training\\nby taking (s, r, o )\u2208PK and replacing owith an-\\nother object \u00afo\u2208Orthat shares the same relation r\\nto keep semantic consistency (e.g. \"Elvis Presley\\nis a citizen of Japan\" , here we replaced \"the USA\"\\nwith a country name: \"Japan\" ). More specifically,\\nthe set of tuples PK that represents the counter-PK\\nis defined as follows:\\nPK=/uniondisplay\\n(s,r,o )\u2208PKCounter-PK k(s, r, o )(2)\\nwhere:\\nCounter-PK k(s, r, o ) = {(s, r, o, \u00afo)|\u00afo\u2208Or\u2227\\n\u00afo\u0338=o\u2227rank \u03b8(\u00afo|s, r)\u2264k}(3)\\nwhere kis the number of counter-knowledge\\ntriplets per triplet (s, r, o )in PK; rank \u03b8(o|s, r)\\nis the rank of \u00afoamong the Orordered by the in-\\ncreasing probability p(\u02c6o|q(s, r))of the LLM to606',\n  'subject rel-lemma object query\\nNewport County A.F.C. is-headquarter Newport Newport County A.F.C. is headquartered in\\nNorway capital-city-of Oslo Norway\u2019s capital city,\\nWWE is-headquarter Stamford WWE is headquartered in\\nPrinceton University Press is-headquarter Princeton Princeton University Press is headquartered in\\nInternet censorship is-subclass censorship Internet censorship is a subclass of\\nMcMurdo Station part-of-continent Antarctica McMurdo Station is a part of the continent of\\nWindows Update product-manufacture-by Microsoft Windows Update, a product manufactured by\\nNintendo located-in Kyoto The headquarter of Nintendo is located in\\nMicrosoft Windows SDK product-manufacture-by Microsoft Microsoft Windows SDK, a product manufactured by\\nHarare capital-of Zimbabwe Harare, the capital of\\nTable 1: A sample of the raw ParaRel dataset (Elazar et al., 2021)\\nquery = \" Virginia\\'s official language is \"\\nVirginia\\'s of ficial language is Croatian .\\nVirginia\\'s of ficial language is Serbian .\\nVirginia\\'s of ficial language is Swedish .P(\"English \" | query) = 0.7\\nP(\"French \" | query) = 0.15\\n.\\n.\\n.\\nP(\"Croatian \" | query) = 0.06\\nP(\"Serbian \" | query) = 0.03\\nP(\"Swedish \" | query) = 0.02\\nFigure 3: Example of 3 counter-knowledge objects that\\nwere associated to a parametric knowledge element.\\nThe probability distribution is ranked in an descendant\\norder and we selected the objects with the lowerst prob-\\nabilities.\\ngenerate an object \u02c6o\u2208Orgiven the prompt q(s, r).\\nWe also make sure that the model has not learned\\nthe(s, r,\u00afo)association by considering the objects\\n\u02c6owith the klowest ranks ( rank \u03b8\u2264k) \u2013 indicating\\nthat the LLM is very unlikely to use its parametric\\nknowledge to generate \u00afo.\\nFigure 3 illustrates the counter-knowledge ob-\\njects that were generated by Phi-1.5 for a paramet-\\nric knowledge example.\\n3.3 Models\\nWe consider decoder-only Transformer models.\\nBetween layer landl\u22121, the hidden state X(l\u22121)\\nis updated by:\\nX(l)=\u03b3(X(l\u22121)+A(l)))+M(l)(4)\\nwhere A(l)andM(l)are the outputs of the MHSA\\nand MLP modules respectively, and \u03b3is a non-\\nlinearity.\\nThe MLP module is a two-layer neural network\\nparameterized by matrices W(l)\\nmlp\u2208Rd\u00d7dmlpand\\nW(l)\\nproj\u2208Rdmlp\u00d7d:\\nM(l)=\u03c3(X(l)\\nmlpW(l)\\nmlp)W(l)\\nproj\u2208Rn\u00d7d(5)where \u03c3is a non-linearity function (e.g. GeLU)\\nandX(l)\\nmlpis the input of the MLP. We refer the\\nreader to Vaswani et al. (2017) for more details on\\nthe architecture.\\nIn our probing set-up (Section 4), we use the\\nfollowing activations: \u03c3(X(l)\\nmlpW(l)\\nmlp)the first layer\\nof the MLP (referred as MLP-L1 in this paper),\\n\u03c3(X(l)\\nmlpW(l)\\nmlp)W(l)\\nprojthe output of the MLP (i.e.\\nsecond layer, referred as MLP in this paper), and\\nA(l)the output of the MHSA. We consider the first\\nand second MLP layers activations, based on Geva\\net al. (2021) work, and also the MHSA activations\\nas the attentions play a crucial role in informa-\\ntion selection from the MLP memory (Geva et al.,\\n2023).\\nWe evaluate our method on several LLMs with\\ndifferent sizes: Phi-1.5 with 1.3B parameters (Li\\net al., 2023), Pythia-1.4B with 1.4B parameters\\n(Biderman et al., 2023), Mistral-7B with 7B pa-\\nrameters (Jiang et al., 2023), and Llama3-8B with\\n8B parameters (AI@Meta, 2024). Table 2 gives\\ncharacteristics about the LLMs\u2019 modules dimen-\\nsions.\\nModel MLP MLP-L1 MHSA\\nPhi-1.5 2048 8192 2048\\nPythia-1.4B 2048 8192 2048\\nLlama3-8B 4096 14336 4096\\nMistral-7B 4096 14336 4096\\nTable 2: Activation dimensions for Phi-1.5, Pythia-1.4B,\\nLlama3-8B and Mistral-7B for the different considered mod-\\nules (MLP, MLP-L1 and MHSA)\\nDecoding strategy As the generated sequences\\nare short, we use a greedy decoding strategy and\\nlimit the number of generated tokens to 10.\\n4 Probing Set-up\\nTo build our probing dataset, we associate\\neach tuple (s, r, o, \u00afo)\u2208PK with a prompt607',\n  'Relation Group ID Relations #Examples\\ngeographic-geopolitic-language is-headquarter, located-in, headquarters-in, locate, share-border, is-twin-\\ncity-of, located, border-with, is-located, work-in-area, which-is-located,\\ncapital-city-of, part-of-continent, capital-of, headquarter, belong-to-\\ncontinent, based-in, is-citizen-of, that-originate-in, originate-in, is-in,\\nfound-in, share-common-border, is-native-to, is-originally-from, pass-\\naway-in, born-in, hold-citizenship-of, have-citizenship-of, citizen-of,\\nstart-in, formulate-in, legal-term, tie-diplomatic-relations, maintains-\\ndiplomatic-relations, have-diplomatic-relations, native, mother-tongue,\\noriginal-language-is, the-official-language, communicate2815\\ncorporate-products-employment product-manufacture-by, develop-by, owned-by, product-develope-by,\\nproduct-release-by, create-by, product-of, produce-by, owner, is-product-\\nof, is-part-of, who-works-for, employed-by, who-employed-by, works-for,\\nwork-in-field, profession-is, found-employment1217\\nmedia premiere-on, to-debut-on, air-on-originally, debut-on 128\\nreligion official-religion 249\\nhierarchy is-subclass 183\\nnaming-reference is-call-after, is-name-after, is-name-for 6\\noccupy-position play-in-position, who-holds 77\\nplay-instrument play-the 13\\nTable 3: All the relation groups with their corresponding relations and number of examples.\\nprompt (s, r,\u00afo)that corresponds to a natural\\nlanguage statement of (s, r,\u00afo)followed by\\nq(s, r)(see Figure 1). Each prompt is asso-\\nciated with a label among CK, PK, and ND,\\nwhere CK ifG\u03b8(prompt (s, r,\u00afo)) = \u00af o,PKif\\nG\u03b8(prompt (s, r,\u00afo)) = o, and with ND (Not De-\\nfined) otherwise. In this work, we discard tuples\\nassociated with ND.\\nWe specifically probe the activations \u00afoof the\\nobject, sqof the subject in the query, and rqthe\\nrelation in the query. As each of these elements\\nmay have multiple tokens, we use their last tokens\\nas their representative (e.g. for \"Washington\" \u2192\\n[\"Wash\", \"inghton\"] , we consider the activations\\nof the token \"inghton\" ). The fact that this token\\nrepresentation summarizes the entity is intuitively\\ntrue for decoder-only models and has been exper-\\nimentally validated in (Meng et al., 2023; Geva\\net al., 2023).\\nNote that our first probe targets \u00afoas this is\\nwhere the knowledge conflict starts (e.g. Bill\\nGates is the founder of Apple (\u00afo).Bill Gates (sq)\\nis the founder of (rq)_).\\n4.1 Control experiments\\nWe also probe the activations of the first token to\\nmeasure how much of the prediction can be at-\\ntributed to the subject representation itself. Since\\nthe knowledge perturbation starts with the first ob-\\nject token, the first token activations should notindicate the knowledge source. For instance, in\\nParis is located in Italy the representation of the\\nfirst token ( Paris ) should not contain information\\nabout the knowledge source as the perturbation\\nstarts at Italy.\\n4.2 Relation Groups\\nTo avoid syntactic and semantic biases related to\\nthe type of relation when training a classifier, we\\ngrouped the relations that are similar into relation\\ngroups. The relation groups are illustrated in Ta-\\nble 3.\\n4.3 Evaluation\\nWe use each relation group as a test set and train\\non the rest of the relation groups. We make sure\\nthat the train and test sets do not share similar\\nsubjects and objects to avoid biases related to the\\nsyntax or the nature of the relation and subject. We\\nensure the train set is balanced (equal number of\\nCK and PK), as current LLMs are more likely to\\nuse context information (CK) than their parametric\\nknowledge Xie et al. (2024). This is illustrated by\\nFigure 4 (and Figure 7 in appendix for a breakdown\\nby relation), where we can see that the considered\\nLLMs mostly generate CK-based outputs.\\nWe also ensure that the test set is balanced so\\nwe can use the success rate (accuracy) as the main\\nmetric \u2013\u2013 with 50% being the performance of a ran-\\ndom classifier. We compute the success rate pifor608'])\n[Jupyter current working directory: /workspace/benchmark/datasets]\n[Jupyter Python interpreter: /openhands/poetry/openhands-ai-5O4_aCHf-py3.12/bin/python]", "extras": {"code": "import PyPDF2\npdf_path = '/workspace/benchmark/datasets/16-KnowProb/KnowProb-main/paper.pdf'\nwith open(pdf_path, 'rb') as f:\n    reader = PyPDF2.PdfReader(f)\n    num_pages = len(reader.pages)\n    first_page = reader.pages[0].extract_text()\n    last_page = reader.pages[-1].extract_text()\n    sample_pages = [reader.pages[i].extract_text() for i in range(min(5, num_pages))]\nnum_pages, first_page[:500], last_page[:500], sample_pages"}, "success": true}